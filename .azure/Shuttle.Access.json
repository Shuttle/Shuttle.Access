{"source":2,"revision":53,"description":null,"createdBy":{"displayName":"Eben Roux","url":"https://spsprodweu1.vssps.visualstudio.com/A75bb4364-7a6e-4c59-a955-438ed23d118c/_apis/Identities/e1ae54d4-848c-4d21-9556-0625be85f026","_links":{"avatar":{"href":"https://dev.azure.com/shuttle-devops/_apis/GraphProfile/MemberAvatars/msa.ZDA5MjkzYTItZmE1NC03YWUzLTlmNTctN2UzODQyNjg1Mjlm"}},"id":"e1ae54d4-848c-4d21-9556-0625be85f026","uniqueName":"me@ebenroux.co.za","imageUrl":"https://dev.azure.com/shuttle-devops/_apis/GraphProfile/MemberAvatars/msa.ZDA5MjkzYTItZmE1NC03YWUzLTlmNTctN2UzODQyNjg1Mjlm","descriptor":"msa.ZDA5MjkzYTItZmE1NC03YWUzLTlmNTctN2UzODQyNjg1Mjlm"},"createdOn":"2020-10-18T13:38:27.793Z","modifiedBy":{"displayName":"Eben Roux","url":"https://spsprodweu1.vssps.visualstudio.com/A75bb4364-7a6e-4c59-a955-438ed23d118c/_apis/Identities/e1ae54d4-848c-4d21-9556-0625be85f026","_links":{"avatar":{"href":"https://dev.azure.com/shuttle-devops/_apis/GraphProfile/MemberAvatars/msa.ZDA5MjkzYTItZmE1NC03YWUzLTlmNTctN2UzODQyNjg1Mjlm"}},"id":"e1ae54d4-848c-4d21-9556-0625be85f026","uniqueName":"me@ebenroux.co.za","imageUrl":"https://dev.azure.com/shuttle-devops/_apis/GraphProfile/MemberAvatars/msa.ZDA5MjkzYTItZmE1NC03YWUzLTlmNTctN2UzODQyNjg1Mjlm","descriptor":"msa.ZDA5MjkzYTItZmE1NC03YWUzLTlmNTctN2UzODQyNjg1Mjlm"},"modifiedOn":"2021-03-16T09:52:57.857Z","isDeleted":false,"lastRelease":{"id":59,"name":"Release-57","artifacts":[],"_links":{},"description":"","releaseDefinition":{"id":2,"projectReference":null,"_links":{}},"createdOn":"2021-03-05T08:13:02.473Z","createdBy":{"displayName":"Eben Roux","url":"https://spsprodweu1.vssps.visualstudio.com/A75bb4364-7a6e-4c59-a955-438ed23d118c/_apis/Identities/e1ae54d4-848c-4d21-9556-0625be85f026","_links":{"avatar":{"href":"https://dev.azure.com/shuttle-devops/_apis/GraphProfile/MemberAvatars/msa.ZDA5MjkzYTItZmE1NC03YWUzLTlmNTctN2UzODQyNjg1Mjlm"}},"id":"e1ae54d4-848c-4d21-9556-0625be85f026","uniqueName":"me@ebenroux.co.za","imageUrl":"https://dev.azure.com/shuttle-devops/_apis/GraphProfile/MemberAvatars/msa.ZDA5MjkzYTItZmE1NC03YWUzLTlmNTctN2UzODQyNjg1Mjlm","descriptor":"msa.ZDA5MjkzYTItZmE1NC03YWUzLTlmNTctN2UzODQyNjg1Mjlm"}},"variables":{},"variableGroups":[1],"environments":[{"id":2,"name":"Development","rank":1,"owner":{"displayName":"Eben Roux","url":"https://spsprodweu1.vssps.visualstudio.com/A75bb4364-7a6e-4c59-a955-438ed23d118c/_apis/Identities/e1ae54d4-848c-4d21-9556-0625be85f026","_links":{"avatar":{"href":"https://dev.azure.com/shuttle-devops/_apis/GraphProfile/MemberAvatars/msa.ZDA5MjkzYTItZmE1NC03YWUzLTlmNTctN2UzODQyNjg1Mjlm"}},"id":"e1ae54d4-848c-4d21-9556-0625be85f026","uniqueName":"me@ebenroux.co.za","imageUrl":"https://dev.azure.com/shuttle-devops/_apis/GraphProfile/MemberAvatars/msa.ZDA5MjkzYTItZmE1NC03YWUzLTlmNTctN2UzODQyNjg1Mjlm","descriptor":"msa.ZDA5MjkzYTItZmE1NC03YWUzLTlmNTctN2UzODQyNjg1Mjlm"},"variables":{},"variableGroups":[],"preDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":4}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":1}},"deployStep":{"id":5},"postDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":6}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":2}},"deployPhases":[{"deploymentInput":{"healthPercent":0,"deploymentHealthOption":"Custom","tags":[],"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[{"alias":"_access","artifactType":"Build","artifactDownloadMode":"All","artifactItems":[]}]},"queueId":11,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":1,"phaseType":4,"name":"Access","refName":null,"workflowTasks":[{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"unzip artifacts","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"unzip $AGENT_RELEASEDIRECTORY/_access/Shuttle-Access/Shuttle.Access.zip -d $AGENT_RELEASEDIRECTORY/_access/Shuttle-Access/\n","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"stop services","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"systemctl -q is-active access-server && sudo systemctl stop access-server && echo \"stopped access-server\" || echo \"access-server not running\"\nsystemctl -q is-active access-projection && sudo systemctl stop access-projection && echo \"stopped access-projection\" || echo \"access-projection not running\"\nsystemctl -q is-active access-webapi && sudo systemctl stop access-webapi && echo \"stopped access-webapi\" || echo \"access-webapi not running\"\n\n\n","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"copy services","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"sudo rm /opt/access-webapi/* -R -f\nsudo mkdir /opt/access-webapi -p\nsudo cp $AGENT_RELEASEDIRECTORY/_access/Shuttle-Access/Shuttle.Access.WebApi/* /opt/access-webapi/. -r\n\nsudo rm /opt/access-server/* -R -f\nsudo mkdir /opt/access-server -p\nsudo cp $AGENT_RELEASEDIRECTORY/_access/Shuttle-Access/Shuttle.Access.Server/* /opt/access-server/. -r\n\nsudo rm /opt/access-projection/* -R -f\nsudo mkdir /opt/access-projection -p\nsudo cp $AGENT_RELEASEDIRECTORY/_access/Shuttle-Access/Shuttle.Access.Projection/* /opt/access-projection/. -r","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"register services","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"sudo cp  /opt/access-webapi/access.webapi.service /etc/systemd/system/access-webapi.service\nsudo cp  /opt/access-server/access.server.service /etc/systemd/system/access-server.service\nsudo cp  /opt/access-projection/access.projection.service /etc/systemd/system/access-projection.service\n\nsudo systemctl daemon-reload\n\nsudo systemctl enable access-webapi\nsudo systemctl enable access-server\nsudo systemctl enable access-projection\n\nsudo systemctl start access-webapi\nsudo systemctl start access-server\nsudo systemctl start access-projection\n\n","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}}]}],"environmentOptions":{"emailNotificationType":"OnlyOnFailure","emailRecipients":"release.environment.owner;release.creator","skipArtifactsDownload":false,"timeoutInMinutes":0,"enableAccessToken":false,"publishDeploymentStatus":true,"badgeEnabled":false,"autoLinkWorkItems":false,"pullRequestDeploymentEnabled":false},"demands":[],"conditions":[{"name":"ReleaseStarted","conditionType":1,"value":""}],"executionPolicy":{"concurrencyCount":1,"queueDepthCount":0},"schedules":[],"currentRelease":{"id":59,"url":"https://vsrm.dev.azure.com/shuttle-devops/9b8d8215-2fe7-4686-9cb8-76ac3dad1524/_apis/Release/releases/59","_links":{}},"retentionPolicy":{"daysToKeep":30,"releasesToKeep":3,"retainBuild":true},"processParameters":{},"properties":{"BoardsEnvironmentType":{"$type":"System.String","$value":"unmapped"},"LinkBoardsWorkItems":{"$type":"System.String","$value":"False"}},"preDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"postDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"environmentTriggers":[],"badgeUrl":"https://vsrm.dev.azure.com/shuttle-devops/_apis/public/Release/badge/9b8d8215-2fe7-4686-9cb8-76ac3dad1524/2/2"}],"artifacts":[{"sourceId":"9b8d8215-2fe7-4686-9cb8-76ac3dad1524:5","type":"Build","alias":"_access","definitionReference":{"artifactSourceDefinitionUrl":{"id":"https://dev.azure.com/shuttle-devops/_permalink/_build/index?collectionId=fb126fe9-e85a-41b4-8ea1-522a2d6123db&projectId=9b8d8215-2fe7-4686-9cb8-76ac3dad1524&definitionId=5","name":""},"defaultVersionBranch":{"id":"","name":""},"defaultVersionSpecific":{"id":"","name":""},"defaultVersionTags":{"id":"","name":""},"defaultVersionType":{"id":"latestType","name":"Latest"},"definition":{"id":"5","name":"Shuttle.Shuttle.Access"},"definitions":{"id":"","name":""},"IsMultiDefinitionType":{"id":"False","name":"False"},"project":{"id":"9b8d8215-2fe7-4686-9cb8-76ac3dad1524","name":"Shuttle"},"repository":{"id":"","name":""}},"isPrimary":true,"isRetained":false}],"triggers":[],"releaseNameFormat":"Release-$(rev:r)","tags":[],"properties":{"DefinitionCreationSource":{"$type":"System.String","$value":"ReleaseNew"},"IntegrateBoardsWorkItems":{"$type":"System.String","$value":"False"},"IntegrateJiraWorkItems":{"$type":"System.String","$value":"false"}},"id":2,"name":"Shuttle.Access","path":"\\","projectReference":null,"url":"https://vsrm.dev.azure.com/shuttle-devops/9b8d8215-2fe7-4686-9cb8-76ac3dad1524/_apis/Release/definitions/2","_links":{"self":{"href":"https://vsrm.dev.azure.com/shuttle-devops/9b8d8215-2fe7-4686-9cb8-76ac3dad1524/_apis/Release/definitions/2"},"web":{"href":"https://dev.azure.com/shuttle-devops/9b8d8215-2fe7-4686-9cb8-76ac3dad1524/_release?definitionId=2"}}}